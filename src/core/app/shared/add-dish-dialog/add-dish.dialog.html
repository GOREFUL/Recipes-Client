<div class="card p-6 max-h-[90vh] overflow-y-auto space-y-6 w-[90vw] max-w-[1200px] mx-auto bg-gray-900 text-gray-100">
  <h2 class="text-2xl font-semibold text-gray-100">Add New Dish</h2>

  <form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="space-y-6">
    
    <section>
      <h3 class="text-lg font-medium mb-2 text-gray-100">Basic Info</h3>
      <div class="grid grid-cols-2 gap-4">
        <mat-form-field appearance="fill" class="w-full" color="primary">
          <mat-label>Name*</mat-label>
          <input matInput formControlName="name" class="bg-gray-800 text-gray-100" required />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full" color="primary">
          <mat-label>Description*</mat-label>
          <textarea matInput rows="3" formControlName="description" class="bg-gray-800 text-gray-100" required></textarea>
        </mat-form-field>
      </div>
    </section>
<section>
  <h3 class="text-lg font-medium mb-2 text-gray-100">Level</h3>
  <mat-form-field class="w-full" appearance="fill" color="primary">
    <mat-label>Difficulty</mat-label>
    <mat-select formControlName="levelId" panelClass="dark-select" required>
      <mat-option *ngFor="let l of levelsLkp" [value]="l.id">{{ l.name }}</mat-option>
    </mat-select>
  </mat-form-field>
</section>

<section>
  <h3 class="text-lg font-medium mb-2 text-gray-100">Allergies</h3>
  <mat-form-field class="w-full" appearance="fill" color="primary">
    <mat-label>Select allergies</mat-label>
    <mat-select formControlName="allergyIds" multiple panelClass="dark-select">
      <mat-option *ngFor="let a of allergiesLkp" [value]="a.id">{{ a.name }}</mat-option>
    </mat-select>
  </mat-form-field>
</section>

<section>
  <h3 class="text-lg font-medium mb-2 text-gray-100">Cuisine</h3>
  <mat-form-field class="w-full" appearance="fill" color="primary">
    <mat-label>Select cuisines</mat-label>
    <mat-select formControlName="cuisineIds" multiple panelClass="dark-select">
      <mat-option *ngFor="let c of cuisinesLkp" [value]="c.id">{{ c.name }}</mat-option>
    </mat-select>
  </mat-form-field>
</section>


<!-- INGREDIENTS -->
<section>
  <h3 class="text-lg font-medium mb-2 text-gray-100">Ingredients</h3>

  <table class="w-full text-sm border border-gray-700 bg-gray-800 text-gray-100">
    <thead class="bg-gray-900 text-gray-100">
      <tr>
        <th class="p-2 text-left">Ingredient</th>
        <th class="p-2 text-left">Measure</th>
        <th class="p-2 text-left">Value</th>
        <th class="p-2 text-right">Actions</th>
      </tr>
    </thead>

    <tbody formArrayName="ingredients">
      <tr *ngFor="let ing of ingredientsFA.controls; let i = index" [formGroupName]="i" class="border-b border-gray-700">
        <!-- ingredient -->
        <td class="p-2 w-1/3">
          <mat-form-field class="w-full" appearance="fill" color="primary">
            <mat-label>Ingredient</mat-label>
            <mat-select formControlName="ingredientId" panelClass="dark-select" required>
              <mat-option *ngFor="let it of ingredientsLkp" [value]="it.id">{{ it.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <!-- unit -->
        <td class="p-2 w-1/4">
          <mat-form-field class="w-full" appearance="fill" color="primary">
            <mat-label>Measure</mat-label>
            <mat-select formControlName="measurementUnitId" panelClass="dark-select" required>
              <mat-option *ngFor="let u of unitsLkp" [value]="u.id">{{ u.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <!-- value -->
        <td class="p-2 w-1/4">
          <mat-form-field class="w-full" appearance="fill" color="primary">
            <mat-label>Value</mat-label>
            <input matInput type="number" formControlName="value" class="bg-gray-700 text-gray-100" />
          </mat-form-field>
        </td>

        <!-- actions -->
        <td class="text-right p-2">
          <button mat-icon-button color="primary" (click)="removeIngredient(i)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pt-2">
    <button mat-stroked-button color="primary" type="button" (click)="addIngredient()">+ Add Ingredient</button>
  </div>
</section>

<!-- IMAGES -->
<section>
  <h3 class="text-lg font-medium mb-2 text-gray-100">Images</h3>

  <table class="w-full text-sm border border-gray-700 bg-gray-800 text-gray-100">
    <thead class="bg-gray-900 text-gray-100">
      <tr>
        <th class="p-2 text-left">Image URL</th>
        <th class="p-2 text-left">Description</th>
        <th class="p-2 text-right">Actions</th>
      </tr>
    </thead>

    <tbody formArrayName="images">
      <tr *ngFor="let img of imagesFA.controls; let i = index" [formGroupName]="i" class="border-b border-gray-700">
        <td class="p-2 w-2/3">
          <input matInput formControlName="url" class="w-full bg-gray-700 text-gray-100" placeholder="https://..." />
        </td>
        <td class="p-2 w-1/3">
          <input matInput formControlName="description" class="w-full bg-gray-700 text-gray-100" placeholder="optional description" />
        </td>
        <td class="text-right p-2">
          <button mat-icon-button color="primary" (click)="removeImage(i)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pt-2">
    <button mat-stroked-button color="primary" type="button" (click)="addImage()">+ Add Image</button>
  </div>
</section>



    <section>
      <h3 class="text-lg font-medium mb-2 text-gray-100">Macronutrients</h3>
      <div class="grid grid-cols-3 gap-3">
        <mat-form-field *ngFor="let field of macronutrientFields" appearance="fill" color="primary">
          <mat-label>{{ field }}</mat-label>
          <input matInput type="number" [formControlName]="field" class="bg-gray-700 text-gray-100" />
        </mat-form-field>
      </div>
    </section>

    <section>
      <h3 class="text-lg font-medium mb-2 text-gray-100">Cook Info</h3>
      <div class="grid grid-cols-2 gap-3">
        <mat-form-field appearance="fill" color="primary">
          <mat-label>Time</mat-label>
          <input matInput formControlName="time" type="time" class="bg-gray-700 text-gray-100" />
        </mat-form-field>

        <mat-form-field appearance="fill" color="primary">
          <mat-label>Yield</mat-label>
          <input matInput type="number" formControlName="yieldVal" class="bg-gray-700 text-gray-100" />
        </mat-form-field>

        <mat-form-field appearance="fill" color="primary">
          <mat-label>Serving Size</mat-label>
          <input matInput type="number" formControlName="servingSize" class="bg-gray-700 text-gray-100" />
        </mat-form-field>

        <mat-form-field appearance="fill" color="primary">
          <mat-label>Note</mat-label>
          <input matInput formControlName="note" class="bg-gray-700 text-gray-100" required/>
        </mat-form-field>
      </div>
    </section>

    <div class="flex justify-end gap-3 pt-4">
      <button mat-stroked-button color="primary" type="button" (click)="onClose()">Cancel</button>
      <button mat-flat-button color="primary" type="submit">Save Dish</button>
    </div>
  </form>
</div>
